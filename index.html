<html>
<head>
    <title>AMTG</title>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0"/>
    <!-- <meta name="viewport" content="width=device-width, initial-scale=1"> -->
    <div data-role="header" data-position="fixed" data-tap-toggle="false">
    <link rel="stylesheet" type="text/css" href="css/themes/default/jquery.mobile-1.3.2.min.css">
    <link rel="stylesheet" type="text/css" href="css/themes/amtg/amtg-theme.min.css">
    <link rel="stylesheet" type="text/css" href="css/style.css">
    <link href="css/jquery.mobile.iscrollview.css" media="screen" rel="stylesheet" type="text/css" />
    <link href="css/jquery.mobile.iscrollview-pull.css" media="screen" rel="stylesheet" type="text/css" />
    
    <!-- Scrollz -->
    <script type="text/javascript" src="js/jquery.min.js"></script>
    <script src="js/layer_xy_hack.js" type="text/javascript"></script>
    <script type="text/javascript" src="js/jquery.mobile-1.3.2.min.js"></script>
    <script src="js/iscroll.js" type="text/javascript"></script>
    <script src="js/jquery.mobile.iscrollview.js" type="text/javascript"></script>
    <script src="js/pull.js" type="text/javascript"></script>

    <script type="text/javascript" src="js/json_request.js"></script>
    <link rel="stylesheet" type="text/css" href="css/style.css">
    
    <script>
        $( document ).on( "pageinit", "#menu-morning-view", function(event) {

            // $.ajax({
            //     url: 'http://project.teamsparrow.net/amtgipad/app/api/get_morning_view',
            //     dataType: "jsonp",
            //     success: function (data) {
            //         console.log(data);
            //         localStorage["date_updated"] = data.date_updated;

            //         //get the categories
            //         var left_menu = "";
            //         $.each(data.categories, function(i, categories){
            //             //alert('Categories ==  '+categories.title);
            //             //left_menu += '<li><a href="javascript:void(0)" rel="morning_view|'+categories.title+'" id="'+categories.id+'">'+categories.title+'</a></li>';
            //         });
            //         localStorage["morning_view_categories"] = left_menu;

            //         //get the articles
            //         ctr = 0;
            //         $.each(data.articles, function(i, articles){
            //             if(ctr == 0)
            //             {
            //                 localStorage["morning_view_initial_title"] = articles.title;
            //                 localStorage["morning_view_initial_body"] = articles.body;
            //                 localStorage['mvac_is_id'] = 'mvac_'+articles.category_id;
            //             }

            //             if (typeof localStorage["mvac_"+articles.category_id] == 'undefined')
            //             {
            //                 localStorage["mvac_"+articles.category_id] = "";
            //             }

            //             //localStorage["mvac_"+articles.category_id] += '<h2 id="article-title">'+articles.title+'</h2>';
            //             //localStorage["mvac_"+articles.category_id] += '<div id="article-body">'+articles.body+'</div>';

            //             ctr++;
            //         });
            //     }
            // });

            // //load the content vila localStorage
            // $("span#date_updated").html(localStorage["date_updated"]);
            // $("h2#article-title").html(localStorage["morning_view_initial_title"]);
            // $("div#article-body").html(localStorage["morning_view_initial_body"]);

            // $('ul#left-menu').empty();
            // $("ul#left-menu").append(localStorage["morning_view_categories"]);
            // $('ul#left-menu').listview('refresh');

            $( document ).on( "swipeleft swiperight", "#menu-morning-view", function( e ) {
                // We check if there is no open panel on the page because otherwise
                // a swipe to close the left panel would also open the right panel (and v.v.).
                // We do this by checking the data that the framework stores on the page element (panel: open).
                if ( $.mobile.activePage.jqmData( "panel" ) !== "open" ) {
                    if ( e.type === "swipeleft"  ) {
                        $( "#right-panel" ).panel( "open" );
                    } else if ( e.type === "swiperight" ) {
                        $( "#left-panel" ).panel( "open" );
                    }
                }
            });

            // Bind events
            // $(document).on('bottomreached', '#article-main', function() {
            //     // Load more
            //     loadMore();
            // });

            // $(document).on('pulled', '#article-main', function() {
            //      // Reset page index
            //     nextPageIndex = 0;

            //     // Reload
            //     loadMore();
            //     //$(this).off( event );
            // });

            //$(this).off( event ); //this is to prevent the page to load multiple times

        });

        // Next page index loaded
        //var nextPageIndex = 0;

        // Indicates if new entries loading is in progress
        //var loading = false;

        // Load more function
        // function loadMore() {
        //     $.ajax({
        //         url: 'http://project.teamsparrow.net/amtgipad/app/api/get_morning_view',
        //         dataType: "jsonp",
        //         success: function (data) {
        //             //console.log(data);
        //             localStorage["date_updated"] = data.date_updated;

        //             //get the categories
        //             var left_menu = "";
        //             $.each(data.categories, function(i, categories){
        //                 //alert('Categories ==  '+categories.title);
        //                 left_menu += '<li><a href="javascript:void(0)" rel="morning_view|'+categories.title+'" id="'+categories.id+'">'+categories.title+'</a></li>';
        //             });
        //             localStorage["morning_view_categories"] = left_menu;

        //             //get the articles
        //             ctr = 0;
        //             var article_main = "";
        //             $.each(data.articles, function(i, articles){
        //                 if(ctr != 0)
        //                 {
        //                     article_main += '<h2 id="article-title">'+articles.title+'</h2>';
        //                     article_main += '<div id="article-body">'+articles.body+'</div>';
        //                 }
        //                 ctr++;
        //             });
        //             $("#article-main").append(article_main);
        //             $("#article-main").scrollz('hidePullHeader');
        //         }
        //     });
        // }

        // Load initial content
        //loadMore();

    </script>
    <style>
    .ui-icon-loading {
        background: url(../images/ajax-loader.gif);
        background-size: 46px 46px;
    }
    
    /*panel scroll*/
    .ui-panel.ui-panel-open {
        position:fixed;
    }
    .ui-panel-inner {
        position: absolute;
        top: 1px;
        left: 0;
        right: 0;
        bottom: 0px;
        overflow: scroll;
        -webkit-overflow-scrolling: touch;
    }


    </style>

    </head>
     <body>
     
        <!-- Home -->
        <!-- <div data-role="page" class="jqm-demos ui-responsive-panel" id="menu-morning-view" data-url="menu-morning-view"> -->
        <div data-role="page" data-iscroll="" class="jqm-demos ui-responsive-panel" id="menu-morning-view">
            <div data-theme="c" data-role="header"  data-position="fixed" class="amtg-header">
                <div class="amtg-logo">
                    <img src="images/logo.png">
                   <!-- TEST -->
            
                </div>


                
                <div style="clear:both"></div>

               <!--  <a href="#">TEST</a>-->
                <a href="#left-panel" data-icon="bars" data-iconpos="notext">Menu</a>

                 <a href="#right-panel" data-icon="search" class="ui-btn-right">Search</a>


                <div data-theme="f" data-role="header">
                    <div data-role="navbar" class="nav-glyphish-example" >
                    <ul id="main-menu">
                        <li><a href="#" class="ui-btn-active" id="morning" data-icon="custom" data-iconpos="top" data-transition="none" data-inline="true">Morning View</a></li>
                        <li><a href="#" id="daily-recap" data-icon="custom" data-iconpos="top" data-transition="none" data-inline="true">Daily Recap</a></li>
                        <li><a href="#" id="research" data-icon="custom" data-iconpos="top" data-transition="none" data-inline="true">Research</a></li>
                        <li><a href="#" id="funds" data-icon="custom" data-iconpos="top" data-transition="none" data-inline="true">Funds</a></li>
                        <li><a href="#" id="tools" data-icon="custom" data-iconpos="top" data-transition="none" data-inline="true">Tools</a></li>
                    </ul>
                </div><!-- /navbar -->
                </div>
            </div>
            <div data-role="content" class="bg">

                <div class="main-content">
                    <div class="header">
                        <strong><span id="page-article-title">The Morning View</span></strong> (as of <span id="date_updated"><!-- as of Sept. 1, 2012 --></span>)
                    </div>
                    <h1 id="article-category">Asia Pacific<!-- LOCAL NEWS --></h1>
                    <hr>
                    <!-- <div id="article-main" data-scrollz="pull"> -->
                    <div  id="article-main" data-role="content">
                            

                            <div id="is-body"></div>
                            
                            <h2 id="article-title"><!-- Former stockbroker convicted for violations of securities law --></h2>
                            <div id="article-body"></div>
                            
                            <!-- <div class="iscroll-pullup">
                              <span class="iscroll-pull-icon"></span><span class="iscroll-pull-label"></span>
                            </div> -->
                    </div>
                </div>


            </div>
            <!-- <div data-theme="a" data-role="footer" data-position="fixed">
                <h3>
                    Footer
                </h3>
            </div> -->
            <div data-role="panel" data-display="reveal" data-position-fixed="true" data-theme="b" id="left-panel" id="categ-panel">
                <a href="#" id="refresh" data-role="button"  data-theme="c"  data-icon="refresh">Refresh</a>

                <h3 id="left-menu-title">The Morning View</h3>
                <ul data-role="listview" data-theme="c " class="nav-search" id="left-menu">

                </ul>
            </div>
        <div data-role="panel" data-display="overlay"  data-position="right" data-position-fixed="true" data-theme="a" id="right-panel">
            <!-- Activate search here -->
             <!-- <form id="search-form"> -->
                    <h3>Site Search</h3>
                    <input type="search" name="search_keyword" id="search_keyword" value="">
                    <span style="float: right;"><a href="#" id="site-search" data-role="button" data-inline="true" data-theme="b" data-mini="true" data-transition="none">Search</a></span> 
                    <br />
            <!-- </form> -->
            <form>
                <h3>Fund Search</h3>
                <br/>
                <div style="padding-left: 20px;">
                    <label for="fund-brand" class="select">Fund Brand: </label>
                    <select name="fund-brand" id="fund-brand" data-mini="true" data-inline="true"></select>
                    <label for="risk-profile" class="select">Risk Profile: </label>
                    <select name="risk-profile" id="risk-profile" data-mini="true" data-inline="true"></select>
                    <label for="fund-type" class="select">Fund Type: </label>
                    <select name="fund-type" id="fund-type" data-mini="true" data-inline="true"></select>
                    <label for="currency" class="select">Currency: </label>
                    <select name="currency" id="currency" data-mini="true" data-inline="true"></select>
                    <br />
                    <span style="float: right;"><a href="#" id="favorites" data-role="button" data-inline="true" data-theme="d" data-mini="true" data-transition="none">Favorites</a></span>
                    <span style="float: right;"><a href="#" id="morning-view-find-funds" class="find_funds" data-role="button" data-inline="true" data-theme="e" data-mini="true" data-transition="none">Find Funds</a></span> 
                </div>

                <br style="clear:both;" />
                <br style="clear:both;" />
                <ul data-role="listview" data-theme="a" class="nav-search" id="right-menu"></ul>
            </form>
           

        </div>
        </div>
    <script type="text/javascript" src="cordova.js"></script>
        <script type="text/javascript">
            app.initialize();

            $(document).on('click', ".external", function (e) {
                e.preventDefault();
                var targetURL = $(this).attr("href");

                window.open(targetURL, "_system");


            });

            // $(function(){
            //     $("#search-form").submit(function(){
            //         return false; 
            //         //search here.
            //     });
            // });
        </script>
    </body>
</html>